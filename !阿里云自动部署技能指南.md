# ğŸš€ é˜¿é‡Œäº‘è‡ªåŠ¨éƒ¨ç½²æŠ€èƒ½

> ä¸€é”®éƒ¨ç½²åº”ç”¨åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨ 8.215.54.214

---

## ğŸ“‹ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®SSHå¯†é’¥ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰

**æ–¹å¼Aï¼šä½¿ç”¨ç°æœ‰å¯†é’¥**
```bash
# å¤åˆ¶æ‚¨çš„ç§é’¥åˆ°æŒ‡å®šä½ç½®
cp ~/.ssh/your_key ~/.ssh/aliyun_key
chmod 600 ~/.ssh/aliyun_key
```

**æ–¹å¼Bï¼šç”Ÿæˆæ–°å¯†é’¥**
```bash
ssh-keygen -t ed25519 -f ~/.ssh/aliyun_key -C "aliyun-deploy"
# å°†å…¬é’¥æ·»åŠ åˆ°æœåŠ¡å™¨
ssh-copy-id -i ~/.ssh/aliyun_key.pub root@8.215.54.214
```

### 2. æµ‹è¯•è¿æ¥

```bash
~/.openclaw/tools/aliyun-deploy.sh status
```

---

## ğŸ¯ å¯ç”¨å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€
```bash
aliyun-deploy status
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
=== ç³»ç»Ÿä¿¡æ¯ ===
ä¸»æœºå: iZ8psomethingZ
æ“ä½œç³»ç»Ÿ: Ubuntu 22.04 LTS

=== èµ„æºä½¿ç”¨ ===
CPU: 15%
å†…å­˜: 2.1G/4G
ç£ç›˜: 15G/40G (40%)

=== è¿è¡ŒæœåŠ¡ ===
NAMES       STATUS       PORTS
nginx       Up 3 days    0.0.0.0:80->80/tcp
mysql       Up 3 days    3306/tcp
```

### éƒ¨ç½²åº”ç”¨
```bash
aliyun-deploy deploy <åº”ç”¨å> <æœ¬åœ°è·¯å¾„>
```

**ç¤ºä¾‹**ï¼š
```bash
# éƒ¨ç½²å‰ç«¯é¡¹ç›®
aliyun-deploy deploy frontend ./dist

# éƒ¨ç½²åç«¯API
aliyun-deploy deploy backend ./server

# éƒ¨ç½²å®Œæ•´é¡¹ç›®
aliyun-deploy deploy myapp ./build
```

**éƒ¨ç½²æµç¨‹**ï¼š
1. è‡ªåŠ¨å¤‡ä»½æ—§ç‰ˆæœ¬
2. rsyncåŒæ­¥æ–‡ä»¶
3. è‡ªåŠ¨é‡å¯æœåŠ¡ï¼ˆDocker/PM2ï¼‰

### æŸ¥çœ‹æ—¥å¿—
```bash
aliyun-deploy logs <åº”ç”¨å> [è¡Œæ•°]
```

**ç¤ºä¾‹**ï¼š
```bash
# æŸ¥çœ‹æœ€å100è¡Œæ—¥å¿—
aliyun-deploy logs myapp

# æŸ¥çœ‹æœ€å500è¡Œæ—¥å¿—
aliyun-deploy logs myapp 500
```

### é‡å¯æœåŠ¡
```bash
aliyun-deploy restart <åº”ç”¨å>
```

### SSHç™»å½•æœåŠ¡å™¨
```bash
aliyun-deploy ssh
```

---

## ğŸ”§ é«˜çº§é…ç½®

### è‡ªå®šä¹‰éƒ¨ç½²ç›®å½•

ç¼–è¾‘è„šæœ¬ä¿®æ”¹å˜é‡ï¼š
```bash
DEPLOY_DIR="/opt/apps"      # éƒ¨ç½²ç›®å½•
BACKUP_DIR="/opt/backups"   # å¤‡ä»½ç›®å½•
```

### æ”¯æŒçš„åº”ç”¨ç±»å‹

| ç±»å‹ | è‡ªåŠ¨æ£€æµ‹ | éƒ¨ç½²æ–¹å¼ |
|------|---------|---------|
| Docker | docker-compose.yml | docker-compose up -d |
| Node.js | package.json | pm2 start |
| é™æ€ç½‘ç«™ | index.html | nginx/cpåˆ°ç›®å½• |

### æ·»åŠ åˆ«åï¼ˆæ¨èï¼‰

```bash
# æ·»åŠ åˆ° ~/.zshrc æˆ– ~/.bashrc
echo 'alias deploy="~/.openclaw/tools/aliyun-deploy.sh"' >> ~/.zshrc
source ~/.zshrc

# ç°åœ¨å¯ä»¥ä½¿ç”¨
deploy status
deploy deploy myapp ./dist
```

---

## ğŸ“ ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### åœºæ™¯1ï¼šéƒ¨ç½²é™æ€ç½‘ç«™

```bash
# 1. æœ¬åœ°æ„å»º
npm run build

# 2. éƒ¨ç½²åˆ°é˜¿é‡Œäº‘
aliyun-deploy deploy website ./dist

# 3. æŸ¥çœ‹çŠ¶æ€
aliyun-deploy status
```

### åœºæ™¯2ï¼šæ›´æ–°åç«¯æœåŠ¡

```bash
# 1. ä»£ç æ›´æ–°åé‡æ–°éƒ¨ç½²
aliyun-deploy deploy api ./server

# 2. æŸ¥çœ‹è¿è¡Œæ—¥å¿—
aliyun-deploy logs api

# 3. å¦‚æœ‰é—®é¢˜ï¼Œå¿«é€Ÿé‡å¯
aliyun-deploy restart api
```

### åœºæ™¯3ï¼šæ‰¹é‡éƒ¨ç½²

```bash
#!/bin/bash
# deploy-all.sh

aliyun-deploy deploy frontend ./frontend/dist
aliyun-deploy deploy backend ./backend
aliyun-deploy deploy admin ./admin/build

echo "å…¨éƒ¨éƒ¨ç½²å®Œæˆï¼"
aliyun-deploy status
```

---

## ğŸ” å®‰å…¨é…ç½®

### 1. ä½¿ç”¨å¯†é’¥è€Œéå¯†ç 
```bash
# ç¡®ä¿å¯†é’¥æƒé™æ­£ç¡®
chmod 600 ~/.ssh/aliyun_key
chmod 644 ~/.ssh/aliyun_key.pub
```

### 2. é™åˆ¶æœåŠ¡å™¨ç™»å½•IP
åœ¨é˜¿é‡Œäº‘å®‰å…¨ç»„ä¸­ï¼Œé™åˆ¶ä»…å…è®¸æ‚¨çš„IPè®¿é—®22ç«¯å£ã€‚

### 3. å®šæœŸæ›´æ¢å¯†é’¥
å»ºè®®æ¯3-6ä¸ªæœˆæ›´æ¢ä¸€æ¬¡SSHå¯†é’¥ã€‚

---

## ğŸ› æ•…éšœæ’é™¤

### è¿æ¥å¤±è´¥
```
[ERROR] æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ 8.215.54.214
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¼€æœº
2. æ£€æŸ¥å®‰å…¨ç»„æ˜¯å¦æ”¾è¡Œ22ç«¯å£
3. ç¡®è®¤SSHå¯†é’¥å·²é…ç½®ï¼š`ls ~/.ssh/aliyun_key`
4. æµ‹è¯•æ‰‹åŠ¨è¿æ¥ï¼š`ssh -i ~/.ssh/aliyun_key root@8.215.54.214`

### éƒ¨ç½²å¤±è´¥
```
[ERROR] åŒæ­¥æ–‡ä»¶å¤±è´¥
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥æœ¬åœ°è·¯å¾„æ˜¯å¦å­˜åœ¨
2. æ£€æŸ¥æœåŠ¡å™¨ç£ç›˜ç©ºé—´ï¼š`df -h`
3. æ£€æŸ¥æƒé™ï¼šç¡®ä¿æœ‰å†™å…¥æƒé™

### æœåŠ¡å¯åŠ¨å¤±è´¥
```
[ERROR] æœåŠ¡é‡å¯å¤±è´¥
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š`aliyun-deploy logs <åº”ç”¨å>`
2. æ‰‹åŠ¨ç™»å½•æ’æŸ¥ï¼š`aliyun-deploy ssh`
3. æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®

---

## ğŸ“Š ç›‘æ§é›†æˆ

å»ºè®®é…åˆHeartbeatä½¿ç”¨ï¼Œè‡ªåŠ¨ç›‘æ§ï¼š

```yaml
# HEARTBEAT.md æ·»åŠ ç›‘æ§ä»»åŠ¡
- [x] **æœåŠ¡å™¨çŠ¶æ€ç›‘æ§** - é˜¿é‡Œäº‘8.215.54.214
  - Cron: æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡
  - å¼‚å¸¸æ—¶å‘é€é£ä¹¦é€šçŸ¥
```

---

## ğŸ“ è¿›é˜¶æ‰©å±•

### CI/CDé›†æˆ
```yaml
# .github/workflows/deploy.yml
name: Deploy to Aliyun
on:
  push:
    branches: [main]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Deploy
        run: |
          ssh -i ${{ secrets.ALIYUN_KEY }} root@8.215.54.214 \
          "cd /opt/apps && git pull && docker-compose up -d"
```

### è“ç»¿éƒ¨ç½²
```bash
# deploy-blue-green.sh
aliyun-deploy deploy app-blue ./build
sleep 5
curl http://8.215.54.214:8080/health || exit 1
# åˆ‡æ¢æµé‡åˆ°blue
ssh root@8.215.54.214 "nginx -s reload"
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **æœåŠ¡å™¨IP**: 8.215.54.214
- **éƒ¨ç½²è„šæœ¬**: ~/.openclaw/tools/aliyun-deploy.sh
- **SSHé…ç½®**: ~/.ssh/config

**é‡åˆ°é—®é¢˜ï¼Ÿ**
1. æ£€æŸ¥SSHè¿æ¥ï¼š`ssh root@8.215.54.214`
2. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š`aliyun-deploy logs <åº”ç”¨å>`
3. è”ç³»AIç§˜ä¹¦ååŠ©æ’æŸ¥

---

**é…ç½®æ—¶é—´**: 2026-02-11 21:15  
**é…ç½®è€…**: AIç§˜ä¹¦ ğŸ¦
**æœåŠ¡å™¨**: é˜¿é‡Œäº‘ 8.215.54.214
